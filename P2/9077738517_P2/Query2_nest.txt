/* 9077738517 */
SELECT 
    SUPNATION.n_name as SUPPLIERNAME, sum(L_QUANTITY * (L_EXTENDEDPRICE - L_DISCOUNT)) as ORDER_WITHIN_NATION
FROM
    ((SELECT 
          *
     FROM
         SUPPLIER, PARTSUPP, LINEITEM, ORDERS, CUSTOMER
     WHERE
          S_SUPPKEY = PS_SUPPKEY and
          PS_PARTKEY = L_PARTKEY and
          PS_SUPPKEY = L_SUPPKEY and
          O_ORDERKEY = L_ORDERKEY and
          C_CUSTKEY = O_CUSTKEY)
     JOIN
         NATION SUPNATION on SUPNATION.N_NATIONKEY = S_NATIONKEY
     JOIN
         NATION CUSTNATION on CUSTNATION.N_NATIONKEY = C_NATIONKEY)
WHERE
    SUPNATION.N_NATIONKEY = CUSTNATION.N_NATIONKEY
GROUP BY
    SUPNATION.N_NAME
ORDER BY
    SUPNATION.N_NAME asc;